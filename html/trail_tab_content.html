<!-- Trail Running / Mountain Analytics Tab -->
<div class="tab-pane fade" id="run-trail-pane" role="tabpanel">
    <div class="row">
        <!-- INTRODUCCIÓN -->
        <div class="col-12 mb-4">
            <div class="glass-card border-start border-4 border-success">
                <h4 class="text-white mb-2"><ion-icon name="trail-sign-outline" class="me-2"></ion-icon>Trail Running
                    Analytics</h4>
                <p class="text-secondary mb-0">
                    En la montaña, el ritmo por kilómetro (min/km) no cuenta toda la verdad. Esta herramienta utiliza
                    algoritmos científicos (Minetti, Banister) para calcular tu
                    <strong class="text-success">Esfuerzo Real (GAP)</strong>, <strong class="text-danger">Carga Interna
                        (TRIMP)</strong> y <strong class="text-warning">Gasto Energético</strong> considerando la
                    gravedad y el desnivel.
                </p>
            </div>
        </div>

        <!-- 1. GAP CALCULATOR -->
        <div class="col-lg-6 mb-4">
            <div class="glass-card h-100">
                <div class="d-flex align-items-center mb-3">
                    <div class="bg-success bg-opacity-10 p-2 rounded me-3 text-success">
                        <ion-icon name="speedometer" class="fs-4"></ion-icon>
                    </div>
                    <div>
                        <h5 class="mb-0">Calculadora GAP (Minetti)</h5>
                        <small class="text-secondary">Ritmo Ajustado a Pendiente</small>
                    </div>
                </div>

                <div class="row g-2 mb-3">
                    <div class="col-6">
                        <label class="form-label small">Distancia (km)</label>
                        <input type="number" id="gapDist" class="form-control" placeholder="21.5">
                    </div>
                    <div class="col-6">
                        <label class="form-label small">Desnivel Positivo (m+)</label>
                        <input type="number" id="gapElev" class="form-control" placeholder="1200">
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label small">Tiempo Total (HH:MM:SS)</label>
                    <div class="input-group">
                        <span class="input-group-text bg-dark-subtle border-secondary"><ion-icon
                                name="time-outline"></ion-icon></span>
                        <input type="text" id="gapTimeInput" class="form-control" placeholder="ej. 01:45:30 o 45:00">
                    </div>
                </div>
                <button class="btn btn-success w-100 mb-4" onclick="calculateGAP()">Calcular Rendimiento</button>

                <!-- Result GAP -->
                <div id="gapResults" class="d-none animate-slide-in">
                    <div class="row text-center mb-3">
                        <div class="col-6">
                            <small class="text-secondary d-block">Ritmo Real</small>
                            <span class="fs-4 fw-bold text-white" id="resPace">--:--</span> <small
                                class="text-secondary">/km</small>
                        </div>
                        <div class="col-6">
                            <small class="text-success d-block fw-bold">Ritmo GAP</small>
                            <span class="fs-3 fw-bold text-success" id="resGAP">--:--</span> <small
                                class="text-secondary">/km</small>
                        </div>
                    </div>
                    <div class="progress bg-secondary bg-opacity-25" style="height: 10px;">
                        <div id="gradeBar" class="progress-bar bg-info" role="progressbar" style="width: 0%"></div>
                    </div>
                    <div class="d-flex justify-content-between small text-secondary mt-1">
                        <span>Pendiente Media</span>
                        <span id="resGrade" class="text-white fw-bold">0%</span>
                    </div>
                    <div class="alert alert-dark border-secondary mt-3 mb-0 small">
                        <i class="fa-solid fa-lightbulb text-warning me-1"></i> <span id="gapExplanation">--</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- 2. TRIMP CALCULATOR -->
        <div class="col-lg-6 mb-4">
            <div class="glass-card h-100">
                <div class="d-flex align-items-center mb-3">
                    <div class="bg-danger bg-opacity-10 p-2 rounded me-3 text-danger">
                        <ion-icon name="heart" class="fs-4"></ion-icon>
                    </div>
                    <div>
                        <h5 class="mb-0">TRIMP (Carga Interna)</h5>
                        <small class="text-secondary">Impulso de Entrenamiento (Banister)</small>
                    </div>
                </div>

                <div class="row g-2 mb-3">
                    <div class="col-8">
                        <label class="form-label small">Duración (min)</label>
                        <input type="number" id="trimpTime" class="form-control" placeholder="Minutos">
                    </div>
                    <div class="col-4">
                        <label class="form-label small">Género</label>
                        <select id="trimpGender" class="form-select">
                            <option value="male">Hombre</option>
                            <option value="female">Mujer</option>
                        </select>
                    </div>
                </div>
                <div class="row g-2 mb-3">
                    <div class="col-4">
                        <label class="form-label small">FC Reposo</label>
                        <input type="number" id="hrRest" class="form-control" placeholder="50">
                    </div>
                    <div class="col-4">
                        <label class="form-label small">FC Máx</label>
                        <input type="number" id="hrMax" class="form-control" placeholder="190">
                    </div>
                    <div class="col-4">
                        <label class="form-label small">FC Media</label>
                        <input type="number" id="hrAvg" class="form-control border-danger text-danger fw-bold"
                            placeholder="155">
                    </div>
                </div>

                <button class="btn btn-danger w-100 mb-4" onclick="calculateTRIMP()">Calcular Estrés</button>

                <!-- Result TRIMP -->
                <div id="trimpResults" class="d-none text-center animate-slide-in">
                    <small class="text-secondary d-block uppercase">Puntuación TRIMP</small>
                    <h2 class="display-3 fw-bold text-danger mb-0" id="trimpValue">--</h2>
                    <small class="text-secondary">puntos de estrés</small>

                    <div
                        class="mt-3 text-start bg-dark bg-opacity-50 p-3 rounded border border-secondary border-opacity-25">
                        <strong class="d-block text-white mb-1">Diagnóstico:</strong>
                        <p id="trimpDiagnosis" class="small text-secondary mb-0 leading-relaxed">--</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 3. CALORIES CALCULATOR -->
        <div class="col-12">
            <div class="glass-card">
                <div class="d-flex align-items-center mb-3">
                    <div class="bg-warning bg-opacity-10 p-2 rounded me-3 text-warning"
                        style="color:#fd7e14 !important">
                        <ion-icon name="flame" class="fs-4"></ion-icon>
                    </div>
                    <div>
                        <h5 class="mb-0">Gasto Energético Real</h5>
                        <small class="text-secondary">Incluye ineficiencia vertical (gravedad)</small>
                    </div>
                </div>

                <div class="row g-3 align-items-end">
                    <div class="col-md-3">
                        <label class="form-label small">Peso Total (kg)</label>
                        <input type="number" id="calWeight" class="form-control" placeholder="70">
                    </div>
                    <div class="col-md-3">
                        <label class="form-label small">Distancia (km)</label>
                        <input type="number" id="calDist" class="form-control" placeholder="15">
                    </div>
                    <div class="col-md-3">
                        <label class="form-label small">Desnivel + (m)</label>
                        <input type="number" id="calElev" class="form-control" placeholder="800">
                    </div>
                    <div class="col-md-3">
                        <button class="btn btn-warning w-100 text-white" onclick="calculateCalories()"
                            style="background-color:#fd7e14; border:none;">Calcular</button>
                    </div>
                </div>

                <!-- Result Calories -->
                <div id="calResultBox" class="d-none mt-4 p-3 rounded d-flex justify-content-between align-items-center"
                    style="background: rgba(253, 126, 20, 0.1); border: 1px solid rgba(253, 126, 20, 0.3);">
                    <div>
                        <strong class="d-block" style="color:#fd7e14">Calorías Totales Estimadas</strong>
                        <small class="text-secondary opacity-75">Metabolismo Basal + Coste Mecánico Vertical</small>
                    </div>
                    <div class="text-end">
                        <span id="calValue" class="display-6 fw-bold" style="color:#fd7e14">0</span>
                        <small class="fw-bold" style="color:#fd7e14">kcal</small>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>